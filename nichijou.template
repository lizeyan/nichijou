#!/usr/bin/env bash
cmd=${1}
extra_params=${@:2}
docker_exec=docker
user={{ username }}
tag={{ docker_image }}:{{ tag }}_{% if gpu %}gpu{% else %}cpu{% endif %}
echo cmd: ${cmd}
echo extra params: ${extra_params}
cmd="sudo ${docker_exec} {% if gpu %}--gpus all{% endif %} run -it --user $(id -u) ${extra_params} -v /home/${user}:/home/${user} -e USERNAME=${user} ${tag} ${cmd}"
echo ${cmd}
${cmd}
